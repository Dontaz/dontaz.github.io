<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Конструктор карточек (Real-time Preview)</title>
	<style>
		:root {
			--bg-color: #050505;
			--card-bg: #0a0a0a;
			--text-main: #ededed;
			--text-secondary: #a1a1aa;
			--accent: #7c3aed;
			--accent-gradient: linear-gradient(135deg, #7c3aed 0%, #2563eb 100%);
			--modal-overlay: rgba(0, 0, 0, 0.85);
			--panel: #171717;
			--border: #333;
		}

		body {
			background-color: var(--bg-color);
			color: var(--text-main);
			font-family: 'Inter', 'Segoe UI', sans-serif;
			padding: 40px;
			display: flex;
			gap: 40px;
			margin: 0;
			box-sizing: border-box;
		}

		.form-panel {
			flex: 1;
			max-width: 500px;
			background: var(--panel);
			padding: 30px;
			border-radius: 16px;
			border: 1px solid var(--border);
			height: fit-content;
		}

		.preview-panel {
			flex: 1;
			display: flex;
			flex-direction: column;
			align-items: flex-start;
			position: sticky;
			top: 40px;
		}

		h2 {
			margin-bottom: 20px;
			color: var(--accent);
			margin-top: 0;
		}

		label {
			display: block;
			margin-bottom: 5px;
			color: #a1a1aa;
			font-size: 0.9rem;
		}

		input, textarea {
			width: 100%;
			background: var(--bg-color);
			border: 1px solid var(--border);
			color: #fff;
			padding: 10px;
			border-radius: 6px;
			margin-bottom: 15px;
			font-family: inherit;
			box-sizing: border-box;
			transition: border-color 0.2s;
		}

			input:focus, textarea:focus {
				outline: none;
				border-color: var(--accent);
			}

		textarea {
			height: 100px;
			resize: vertical;
		}

		.btn-group {
			display: flex;
			gap: 10px;
			margin-bottom: 0;
			align-items: stretch;
		}

		button {
			padding: 12px;
			background: var(--accent);
			color: white;
			border: none;
			border-radius: 6px;
			font-weight: bold;
			cursor: pointer;
			transition: 0.2s;
			font-size: 0.95rem;
		}

			button:hover {
				background: #6d28d9;
			}

		.gen-btn {
			flex-grow: 1;
		}

		.reset-btn {
			background: #262626;
			color: #a1a1aa;
			border: 1px solid var(--border);
		}

			.reset-btn:hover {
				background: #ef4444;
				color: white;
				border-color: #ef4444;
			}

		.tool-btn {
			width: 48px;
			flex-shrink: 0;
			background: #3b82f6;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 1.2rem;
			font-family: serif;
		}

			.tool-btn:hover {
				background: #2563eb;
			}

			.tool-btn svg {
				width: 20px;
				height: 20px;
				fill: currentColor;
			}

		.output-area {
			margin-top: 20px;
			display: none;
		}

			.output-area.visible {
				display: block;
				animation: fadeIn 0.3s ease;
			}

		@keyframes fadeIn {
			from {
				opacity: 0;
				transform: translateY(-10px);
			}

			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		.copy-btn {
			background: #22c55e;
			margin-top: 10px;
			width: 100%;
		}

			.copy-btn:hover {
				background: #16a34a;
			}

		#previewCanvas {
			width: 100%;
			max-width: 350px;
		}

		.card {
			background-color: var(--card-bg);
			border-radius: 16px;
			overflow: hidden;
			cursor: pointer;
			position: relative;
			box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
			display: flex;
			flex-direction: column;
			border: 1px solid transparent;
			background: linear-gradient(var(--card-bg), var(--card-bg)) padding-box, linear-gradient(145deg, rgba(255,255,255,0.05), rgba(255,255,255,0.01)) border-box;
			transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
			margin: 0;
		}

			.card:hover {
				transform: translateY(-7px);
				box-shadow: 0 0 30px rgba(124, 58, 237, 0.15), inset 0 0 20px rgba(0,0,0,0.8);
				background: linear-gradient(var(--card-bg), var(--card-bg)) padding-box, linear-gradient(var(--bg-angle, 135deg), #7c3aed, #2563eb, #6366f1, #7c3aed) border-box;
				background-size: 200% 200%;
				animation: gradientBorder 3s ease infinite;
			}

		@keyframes gradientBorder {
			0% {
				background-position: 0% 50%;
			}

			50% {
				background-position: 100% 50%;
			}

			100% {
				background-position: 0% 50%;
			}
		}

		.card-image {
			height: 200px;
			position: relative;
			overflow: hidden;
			background-color: #1a1a1a;
			z-index: 0;
			flex-shrink: 0;
			border-bottom: 1px solid rgba(255,255,255,0.05);
		}

			.card-image::before {
				content: '';
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background-image: var(--bg-img);
				background-size: cover;
				background-position: center;
				filter: blur(20px) brightness(0.6);
				transform: scale(1.2);
				z-index: -1;
			}

			.card-image::after {
				content: '';
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background-image: var(--bg-img);
				background-size: contain;
				background-position: center;
				background-repeat: no-repeat;
				z-index: 1;
				transition: transform 0.4s ease, filter 0.4s ease;
				filter: brightness(1);
			}

		.card:hover .card-image::after {
			filter: brightness(1.1);
			transform: scale(1.05);
		}

		.card-content {
			padding: 25px;
			display: flex;
			flex-direction: column;
			flex-grow: 1;
			position: relative;
			z-index: 2;
		}

		.card-title {
			font-size: 1.4rem;
			margin-bottom: 8px;
			font-weight: 700;
			color: #fff;
			transition: color 0.3s;
			margin-top: 0;
		}

		.card:hover .card-title {
			background: var(--accent-gradient);
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
		}

		.card-short-desc {
			color: var(--text-secondary);
			font-size: 0.95rem;
			margin-bottom: 20px;
			line-height: 1.5;
			flex-grow: 1;
		}

		.card-tags {
			display: flex;
			flex-wrap: wrap;
			gap: 8px;
			margin-top: auto;
		}

		.tag {
			background: rgba(255, 255, 255, 0.03);
			color: #d4d4d8;
			padding: 6px 12px;
			border-radius: 6px;
			font-size: 0.75rem;
			font-weight: 500;
			border: 1px solid rgba(255, 255, 255, 0.1);
			transition: 0.3s;
		}

		.card:hover .tag {
			border-color: rgba(124, 58, 237, 0.5);
			background: rgba(124, 58, 237, 0.1);
			color: #fff;
		}

		.modal-overlay {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: var(--modal-overlay);
			backdrop-filter: blur(8px);
			display: flex;
			justify-content: center;
			align-items: center;
			opacity: 0;
			visibility: hidden;
			transition: all 0.3s ease;
			z-index: 2000;
			padding: 20px;
		}

			.modal-overlay.active {
				opacity: 1;
				visibility: visible;
			}

		.modal-content {
			background-color: #0f0f0f;
			border-radius: 20px;
			max-width: 650px;
			width: 100%;
			position: relative;
			transform: scale(0.9);
			transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
			border: 1px solid rgba(124, 58, 237, 0.2);
			box-shadow: 0 0 50px -10px rgba(124, 58, 237, 0.2);
			display: flex;
			flex-direction: column;
			max-height: 85vh;
			padding: 0;
			overflow: hidden;
		}

		.modal-header {
			padding: 30px 40px 10px 40px;
			flex-shrink: 0;
			position: relative;
			background-color: #0f0f0f;
			z-index: 20;
		}

		.modal-body {
			padding: 10px 40px 40px 40px;
			overflow-y: auto;
			flex-grow: 1;
			color: #d1d5db;
		}

			.modal-body::-webkit-scrollbar {
				width: 8px;
			}

			.modal-body::-webkit-scrollbar-track {
				background: rgba(255, 255, 255, 0.02);
				border-radius: 4px;
			}

			.modal-body::-webkit-scrollbar-thumb {
				background: rgba(255, 255, 255, 0.15);
				border-radius: 4px;
			}

				.modal-body::-webkit-scrollbar-thumb:hover {
					background: rgba(255, 255, 255, 0.25);
				}

		.modal-overlay.active .modal-content {
			transform: scale(1);
		}

		.close-btn {
			position: absolute;
			top: 25px;
			right: 25px;
			font-size: 2.5rem;
			cursor: pointer;
			color: var(--text-secondary);
			transition: color 0.2s ease;
			line-height: 1;
			font-weight: 300;
			z-index: 30;
		}

			.close-btn:hover {
				color: #ffffff;
			}

		#modal-title {
			margin-bottom: 10px;
			font-size: 2rem;
			background: var(--accent-gradient);
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			display: inline-block;
			margin-right: 40px;
			margin-top: 0;
		}

		#modal-desc {
			color: #d1d5db;
			font-size: 1rem;
			line-height: 1.7;
			white-space: pre-line;
		}

			#modal-desc a {
				color: var(--accent);
				text-decoration: none;
				border-bottom: 1px dashed var(--accent);
				transition: all 0.2s ease;
				font-weight: 600;
			}

				#modal-desc a:hover {
					color: #fff;
					border-bottom-style: solid;
					background: rgba(124, 58, 237, 0.1);
				}

		#modal-tags {
			display: flex;
			flex-wrap: wrap;
			gap: 10px;
			margin-top: 30px;
			border-top: 1px solid #333;
			padding-top: 20px;
		}

			#modal-tags .tag {
				background: rgba(124, 58, 237, 0.15);
				color: #a78bfa;
				border-color: rgba(124, 58, 237, 0.3);
			}

		#notification {
			visibility: hidden;
			min-width: 250px;
			background-color: var(--panel);
			color: #fff;
			text-align: center;
			border-radius: 8px;
			padding: 16px;
			position: fixed;
			z-index: 3000;
			right: 30px;
			bottom: 30px;
			font-size: 1rem;
			border-left: 5px solid #22c55e;
			box-shadow: 0 10px 25px rgba(0,0,0,0.7);
			opacity: 0;
			transform: translateY(20px);
			transition: opacity 0.3s, transform 0.3s, visibility 0.3s;
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 10px;
		}

			#notification.show {
				visibility: visible;
				opacity: 1;
				transform: translateY(0);
			}

		.check-icon {
			color: #22c55e;
			font-size: 1.2rem;
		}

		.link-modal-overlay {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(0,0,0,0.8);
			display: none;
			justify-content: center;
			align-items: center;
			z-index: 2500;
			backdrop-filter: blur(5px);
		}

		.link-modal-content {
			background: var(--panel);
			padding: 25px;
			border-radius: 12px;
			width: 100%;
			max-width: 400px;
			border: 1px solid var(--border);
			box-shadow: 0 20px 40px rgba(0,0,0,0.5);
		}

		.link-modal-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 20px;
		}

			.link-modal-header h3 {
				margin: 0;
				color: #3b82f6;
			}

		.close-link-modal {
			background: none;
			border: none;
			font-size: 1.5rem;
			padding: 0;
			color: #aaa;
			cursor: pointer;
		}

			.close-link-modal:hover {
				color: #fff;
			}

		@media (max-width: 900px) {
			body {
				flex-direction: column;
			}

			.preview-panel {
				align-items: center;
				position: static;
			}
		}
	</style>
</head>
<body>

	<div class="form-panel">
		<h2>Данные проекта</h2>

		<label>Заголовок проекта</label>
		<input type="text" id="inpTitle" placeholder="Например: Telegram Бот">

		<label>Краткое описание (для карточки)</label>
		<textarea id="inpShort" style="height: 60px;" placeholder="Пара строк, которые видно сразу"></textarea>

		<label>Теги (через запятую)</label>
		<input type="text" id="inpTags" placeholder="Python, Django, API">

		<label>Полное описание (для модального окна)</label>
		<textarea id="inpFull" placeholder="Подробный рассказ о проекте. Выделите текст и нажмите B."></textarea>

		<label>Ссылка на картинку (URL или путь к файлу)</label>
		<input type="text" id="inpImg" placeholder="images/my-project.jpg" value="images/">

		<div class="btn-group">
			<button class="gen-btn" onclick="showCodeBlock()">Показать HTML</button>

			<button class="tool-btn" onclick="makeBold()" title="Сделать жирным (выделите текст)"><b>B</b></button>
			<button class="tool-btn" onclick="openLinkModal()" title="Создать ссылку"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z" /></svg></button>
			<button class="tool-btn" onclick="insertBreak()" title="Вставить перенос строки" style="font-size: 0.8rem;">BR</button>

			<button class="reset-btn" onclick="resetForm()">Сбросить</button>
		</div>

		<div class="output-area" id="outputBlock">
			<label>Код для вставки:</label>
			<textarea id="resultCode" style="height: 150px; font-family: monospace; color: #7c3aed;"></textarea>
			<button class="copy-btn" onclick="copyResultToClipboard()">Копировать код карточки</button>
		</div>
	</div>

	<div class="preview-panel">
		<h2>Предпросмотр</h2>
		<p style="color:#666; margin-bottom: 20px;">Заполняйте форму, превью обновится автоматически.</p>

		<div id="previewCanvas">
			<div style="border: 1px dashed #333; padding: 20px; text-align: center; color: #444; border-radius: 12px;">
				Начните вводить текст...
			</div>
		</div>
	</div>

	<div class="modal-overlay" id="modalOverlay" onclick="closeModal(event)">
		<div class="modal-content">
			<div class="modal-header">
				<span class="close-btn" onclick="closeModalBtn()">&times;</span>
				<h2 id="modal-title">Заголовок</h2>
			</div>
			<div class="modal-body">
				<p id="modal-desc">Описание...</p>
				<div id="modal-tags"></div>
			</div>
		</div>
	</div>

	<div id="linkModal" class="link-modal-overlay" onclick="closeLinkModal(event)">
		<div class="link-modal-content">
			<div class="link-modal-header">
				<h3>Вставка ссылки</h3>
				<span class="close-link-modal" onclick="closeLinkModalBtn()" style="cursor:pointer;">&times;</span>
			</div>
			<label>Текст ссылки</label>
			<input type="text" id="linkText" placeholder="Например: GitHub" autofocus>
			<label>Адрес (URL)</label>
			<input type="text" id="linkUrl" placeholder="https://...">
			<button onclick="generateLink()" style="background: #3b82f6; margin-top: 10px;">Скопировать код ссылки</button>
		</div>
	</div>

	<div id="notification"><span class="check-icon">✔</span></div>

	<script>
		const inputs = ['inpTitle', 'inpShort', 'inpTags', 'inpFull', 'inpImg'];
		inputs.forEach(id => {
			const el = document.getElementById(id);
			el.addEventListener('input', generateCode);
		});

		function generateCode() {
			let title = document.getElementById('inpTitle').value;
			let shortDesc = document.getElementById('inpShort').value;
			let tags = document.getElementById('inpTags').value;
			let fullDesc = document.getElementById('inpFull').value;
			let img = document.getElementById('inpImg').value || '';

			if (!title && !shortDesc && !tags && !fullDesc && img === 'images/') {
				document.getElementById('previewCanvas').innerHTML = `
								<div style="border: 1px dashed #333; padding: 20px; text-align: center; color: #444; border-radius: 12px;">
									Начните вводить текст...
								</div>`;
				document.getElementById('resultCode').value = '';
				return;
			}

			const safeTitle = title.replace(/"/g, '&quot;');
			const safeFullDesc = fullDesc.replace(/"/g, '&quot;');

			const htmlCode = `
<div class="card"
					onclick="openModal(this)"
					data-title="${safeTitle}"
					data-tags="${tags}"
					data-full-desc="${safeFullDesc}">

					<div class="card-image" style="--bg-img: url('${img}');"></div>
					<div class="card-content">
						<h3 class="card-title">${title}</h3>
						<p class="card-short-desc">${shortDesc}</p>
						<div class="card-tags"></div>
					</div>
</div>`;

			document.getElementById('resultCode').value = htmlCode;

			let tagsHtml = '';
			if (tags) {
				tags.split(',').forEach(tag => {
					const t = tag.trim();
					if (t) tagsHtml += `<span class="tag">${t}</span>`;
				});
			}

			const previewHtml = `
								<div class="card"
									onclick="openModal(this)"
									data-title="${safeTitle}"
									data-tags="${tags}"
									data-full-desc="${safeFullDesc}">

									<div class="card-image" style="--bg-img: url('${img}');"></div>
									<div class="card-content">
										<h3 class="card-title">${title || 'Заголовок проекта'}</h3>
										<p class="card-short-desc">${shortDesc || 'Краткое описание...'}</p>
										<div class="card-tags">${tagsHtml}</div>
									</div>
								</div>`;

			document.getElementById('previewCanvas').innerHTML = previewHtml;
		}

		function showCodeBlock() {
			generateCode();
			const outBlock = document.getElementById('outputBlock');
			outBlock.classList.add('visible');
			outBlock.scrollIntoView({ behavior: 'smooth' });
		}

		const modal = document.getElementById('modalOverlay');
		const modalTitle = document.getElementById('modal-title');
		const modalDesc = document.getElementById('modal-desc');
		const modalTags = document.getElementById('modal-tags');

		function openModal(cardElement) {
			const title = cardElement.getAttribute('data-title');
			const desc = cardElement.getAttribute('data-full-desc');
			const tagsRaw = cardElement.getAttribute('data-tags');

			modalTitle.textContent = title;
			modalDesc.innerHTML = desc;

			modalTags.innerHTML = '';
			if (tagsRaw) {
				const tagsArray = tagsRaw.split(',');
				tagsArray.forEach(tagText => {
					if (!tagText.trim()) return;
					const tagSpan = document.createElement('span');
					tagSpan.classList.add('tag');
					tagSpan.textContent = tagText.trim();
					modalTags.appendChild(tagSpan);
				});
			}

			modal.classList.add('active');
			document.body.style.overflow = 'hidden';
		}

		function closeModalBtn() {
			modal.classList.remove('active');
			document.body.style.overflow = 'auto';
		}

		function closeModal(event) {
			if (event.target === modal) closeModalBtn();
		}

		function makeBold() {
			const textarea = document.getElementById('inpFull');
			const start = textarea.selectionStart;
			const end = textarea.selectionEnd;

			if (start === end) {
				showNotification("Сначала выделите текст!");
				return;
			}

			const text = textarea.value;
			const selectedText = text.substring(start, end);
			const replacement = `<b>${selectedText}</b>`;
			textarea.value = text.substring(0, start) + replacement + text.substring(end);
			textarea.focus();

			generateCode();
		}

		function insertBreak() {
			const textarea = document.getElementById('inpFull');
			const start = textarea.selectionStart;
			const end = textarea.selectionEnd;
			const text = textarea.value;
			const replacement = '<br />';
			textarea.value = text.substring(0, start) + replacement + text.substring(end);
			textarea.selectionStart = textarea.selectionEnd = start + replacement.length;
			textarea.focus();
			generateCode();
		}

		function resetForm() {
			document.getElementById('inpTitle').value = '';
			document.getElementById('inpShort').value = '';
			document.getElementById('inpTags').value = '';
			document.getElementById('inpFull').value = '';
			document.getElementById('inpImg').value = 'images/';
			document.getElementById('resultCode').value = '';

			document.getElementById('outputBlock').classList.remove('visible');

			generateCode();
		}

		function copyResultToClipboard() {
			const copyText = document.getElementById("resultCode");
			copyText.select();
			document.execCommand("copy");
			showNotification("Код карточки скопирован!");
		}

		const linkModal = document.getElementById('linkModal');
		const linkTextInput = document.getElementById('linkText');
		const linkUrlInput = document.getElementById('linkUrl');

		function openLinkModal() {
			linkModal.style.display = 'flex';
			linkTextInput.focus();
		}

		function closeLinkModalBtn() {
			linkModal.style.display = 'none';
			linkTextInput.value = '';
			linkUrlInput.value = '';
		}

		function closeLinkModal(event) {
			if (event.target === linkModal) closeLinkModalBtn();
		}

		function generateLink() {
			const text = linkTextInput.value;
			const url = linkUrlInput.value;
			if (!text || !url) { alert("Заполните оба поля"); return; }

			const linkCode = `<a href='${url}' target='_blank'>${text}</a>`;
			navigator.clipboard.writeText(linkCode).then(() => {
				showNotification("Ссылка скопирована! Вставьте её (Ctrl+V)");
				closeLinkModalBtn();
			});
		}

		function showNotification(message) {
			const x = document.getElementById("notification");
			x.innerHTML = `<span class="check-icon">✔</span> ${message}`;
			x.className = "show";
			setTimeout(function () { x.className = x.className.replace("show", ""); }, 3000);
		}

		document.addEventListener('keydown', (e) => {
			if (e.key === "Escape") {
				if (linkModal.style.display === 'flex') closeLinkModalBtn();
				if (modal.classList.contains('active')) closeModalBtn();
			}
		});
	</script>
</body>
</html>